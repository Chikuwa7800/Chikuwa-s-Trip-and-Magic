execute store result score @s ch_tm_re_teleportation_scroll_sec_pos_saver run data get entity @s equipment.offhand.components."minecraft:custom_data"."saved_location"
execute as @e[type=marker,tag=ch_tm_re_teleportation_scroll_marker] if score @s ch_tm_entity_id = @p ch_tm_entity_id if score @s ch_tm_sec_entity_id = @p ch_tm_re_teleportation_scroll_sec_pos_saver at @s run function ch_trip_and_magic:magic/items/artifacts/scroll/rewrited_teleportation_scroll/has_location/teleport_effect
execute as @e[type=marker,tag=ch_tm_re_teleportation_scroll_marker] if score @s ch_tm_entity_id = @p ch_tm_entity_id if score @s ch_tm_sec_entity_id = @p ch_tm_re_teleportation_scroll_sec_pos_saver run function ch_trip_and_magic:magic/items/artifacts/scroll/rewrited_teleportation_scroll/has_location/teleport
execute if predicate ch_trip_and_magic:magic/scroll/damage/offhand/0 if entity @s[gamemode=!creative,gamemode=!spectator] run return run item modify entity @s weapon.offhand ch_trip_and_magic:items/damage_1
execute if predicate ch_trip_and_magic:magic/scroll/damage/offhand/1 if entity @s[gamemode=!creative,gamemode=!spectator] run return run item modify entity @s weapon.offhand ch_trip_and_magic:items/damage_2
execute if predicate ch_trip_and_magic:magic/scroll/damage/offhand/2 if entity @s[gamemode=!creative,gamemode=!spectator] run return run item modify entity @s weapon.offhand ch_trip_and_magic:items/damage_3
execute if predicate ch_trip_and_magic:magic/scroll/damage/offhand/3 if entity @s[gamemode=!creative,gamemode=!spectator] run return run item modify entity @s weapon.offhand ch_trip_and_magic:items/damage_4
execute if predicate ch_trip_and_magic:magic/scroll/damage/offhand/4 if entity @s[gamemode=!creative,gamemode=!spectator] as @e[type=marker,tag=ch_tm_re_teleportation_scroll_marker] if score @s ch_tm_entity_id = @p ch_tm_entity_id if score @s ch_tm_sec_entity_id = @p ch_tm_re_teleportation_scroll_sec_pos_saver at @s run function ch_trip_and_magic:magic/items/artifacts/scroll/rewrited_teleportation_scroll/has_location/remove
execute if predicate ch_trip_and_magic:magic/scroll/damage/offhand/4 if entity @s[gamemode=!creative,gamemode=!spectator] run item replace entity @s weapon.offhand with air
